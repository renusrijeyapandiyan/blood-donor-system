<!DOCTYPE html>
<html>
<head>
  <title>Blood Donor Dashboard</title>
  <link rel="stylesheet" href="style.css">

  <style>

    body{
      background:#f4f6f9;
      font-family: Arial;
      margin:0;
    }

    /* Navbar */
    .navbar{
      background:#d90429;
      color:white;
      padding:15px;
      font-size:22px;
      font-weight:bold;
      text-align:center;
    }

    /* Stats */
    .stats{
      display:flex;
      justify-content:center;
      gap:20px;
      margin:20px;
    }

    .stat-card{
      background:white;
      padding:20px;
      border-radius:10px;
      width:200px;
      text-align:center;
      box-shadow:0 2px 10px rgba(0,0,0,0.1);
    }

    /* Search */
    .search-box{
      text-align:center;
      margin:20px;
    }

    .search-box input{
      padding:10px;
      width:250px;
      border-radius:5px;
      border:1px solid #ccc;
    }

    .search-box button{
      padding:10px 15px;
      border:none;
      background:#d90429;
      color:white;
      border-radius:5px;
      cursor:pointer;
    }

    /* Donor Grid */
    .donor-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(250px,1fr));
      gap:20px;
      padding:20px;
    }

    /* Donor Card */
    .donor-card{
      background:white;
      padding:20px;
      border-radius:10px;
      box-shadow:0 2px 10px rgba(0,0,0,0.1);
    }

    .donor-card h3{
      margin:0;
      color:#d90429;
    }

    .donor-card button{
      margin-top:5px;
      padding:8px;
      width:100%;
      border:none;
      border-radius:5px;
      background:#d90429;
      color:white;
      cursor:pointer;
    }

  </style>

</head>

<body>

<div class="navbar">
ðŸ©¸ Blood Donor Dashboard
</div>

<!-- Stats -->
<div class="stats">
  <div class="stat-card">
    <h2 id="totalDonors">0</h2>
    <p>Total Donors</p>
  </div>

  <div class="stat-card">
    <h2>24/7</h2>
    <p>Emergency Support</p>
  </div>
</div>

<!-- Search -->
<div class="search-box">
  <input id="searchLocation" placeholder="Search by Location">
  <button onclick="searchDonors()">Search</button>
  <button onclick="loadDonors()">Show All</button>
</div>

<!-- Donor List -->
<div class="donor-grid" id="donorList"></div>

<script>

// Load All Donors
async function loadDonors(){
  const res = await fetch("/donors");
  const donors = await res.json();

  document.getElementById("totalDonors").innerText = donors.length;

  showDonors(donors);
}


// Search Donors
async function searchDonors(){
  const loc = document.getElementById("searchLocation").value;

  if(!loc){
    alert("Enter location");
    return;
  }

  const res = await fetch("/donors/location/" + loc);
  const donors = await res.json();

  showDonors(donors);
}


// Show Donors
function showDonors(donors){

  let html = "";

  if(donors.length === 0){
    html = "<h3 style='text-align:center'>No Donors Found</h3>";
  }

  donors.forEach(d => {

    html += `
      <div class="donor-card">
        <h3>${d.name}</h3>
        <p><b>Blood:</b> ${d.bloodGroup}</p>
        <p><b>Phone:</b> ${d.phone}</p>
        <p><b>Location:</b> ${d.location}</p>
        <p><b>Email:</b> ${d.email}</p>

        <a href="tel:${d.phone}">
          <button>ðŸ“ž Call</button>
        </a>

        <a href="mailto:${d.email}">
          <button>âœ‰ Email</button>
        </a>

      </div>
    `;
  });

  document.getElementById("donorList").innerHTML = html;
}

loadDonors();

</script>

</body>
</html>
